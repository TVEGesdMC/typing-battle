
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Typing Battle - Leaderboard</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="leaderboard-container">
        <h1>ğŸ† Hall of Warriors ğŸ†</h1>
        <p>The greatest warriors who have conquered the most levels</p>

        <div id="leaderboard-content"></div>

        <div style="margin-top: 20px;">
            <a href="index.html" class="btn">âš”ï¸ Return to Battle</a>
            <button class="btn btn-secondary" onclick="logout()">ğŸšª Leave Arena</button>
        </div>
    </div>

    <script>
        function loadLeaderboard() {
            const users = JSON.parse(localStorage.getItem('typingBattleUsers') || '{}');
            const currentUser = localStorage.getItem('currentUser');
            const content = document.getElementById('leaderboard-content');

            // Convert users object to array and sort by maxLevel
            const usersArray = Object.values(users).sort((a, b) => (b.maxLevel || 0) - (a.maxLevel || 0));

            if (usersArray.length === 0) {
                content.innerHTML = '<div class="no-data">No warriors have entered the arena yet!</div>';
                return;
            }

            let tableHTML = `
                <table class="leaderboard-table">
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th>Warrior</th>
                            <th>Max Level</th>
                            <th>Games Played</th>
                            <th>Title</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            const youtuberTitles = JSON.parse(localStorage.getItem('youtuberTitles') || '{}');

            usersArray.forEach((user, index) => {
                const rank = index + 1;
                const isCurrentUser = user.username === currentUser;
                const rankClass = rank <= 3 ? `rank-${rank}` : '';
                const rowClass = isCurrentUser ? 'current-user' : '';

                // Determine which title to show (priority: YouTuber > Premium Custom > Regular)
                let titleDisplay = '';
                let titleClass = '';
                
                if (user.activeYoutuberTitle && youtuberTitles[user.activeYoutuberTitle]) {
                    const youtuberTitle = youtuberTitles[user.activeYoutuberTitle];
                    titleDisplay = `ğŸ¬ ${youtuberTitle.name}`;
                    titleClass = 'youtuber-title';
                } else if (user.isPremium && user.customTitle) {
                    titleDisplay = `âœ¨ ${user.customTitle}`;
                    titleClass = 'custom-title';
                } else if (user.title) {
                    titleDisplay = getTitleText(user.title);
                    titleClass = `title-${user.title}`;
                } else {
                    titleDisplay = 'No Title';
                    titleClass = 'no-title';
                }

                tableHTML += `
                    <tr class="${rowClass}">
                        <td class="rank ${rankClass}">${getRankEmoji(rank)}${rank}</td>
                        <td><strong>${user.username}</strong></td>
                        <td>${user.maxLevel || 0}</td>
                        <td>${user.gamesPlayed || 0}</td>
                        <td class="title-cell ${titleClass}">${titleDisplay}</td>
                    </tr>
                `;
            });

            tableHTML += '</tbody></table>';
            content.innerHTML = tableHTML;
        }

        function getRankEmoji(rank) {
            if (rank === 1) return 'ğŸ¥‡ ';
            if (rank === 2) return 'ğŸ¥ˆ ';
            if (rank === 3) return 'ğŸ¥‰ ';
            return '';
        }

        function getTitleText(title) {
            const titles = {
                'swordmaster': 'ğŸ—¡ï¸ Sword Master',
                'champion': 'ğŸ† Champion',
                'legendary': 'ğŸ‘‘ Legendary',
                'pyromaniac': 'ğŸ”¥ Pyromaniac',
                'lightning': 'âš¡ Lightning Fingers',
                'starborn': 'ğŸŒŸ Starborn',
                'realitybender': 'ğŸŒˆ Reality Bender',
                'deathstypist': 'ğŸ’€ Death\'s Typist',
                'quantum': 'ğŸš€ Quantum Warrior',
                'universedestroyer': 'ğŸŒŒ Universe Destroyer',
                'allseeing': 'ğŸ‘ï¸ All-Seeing Typer',
                'wordweaver': 'ğŸ”® Mystic Wordweaver',
                'godslayer': 'âš¡ Godslayer Typist'
            };
            return titles[title] || title;
        }

        function logout() {
            localStorage.removeItem('currentUser');
            window.location.href = 'signup.html';
        }

        // Check authentication
        if (!localStorage.getItem('currentUser')) {
            window.location.href = 'signup.html';
        } else {
            loadLeaderboard();
        }
    </script>
</body>
</html>
