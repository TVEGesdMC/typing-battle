<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Typing Battle - Leaderboard</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="leaderboard-container">
        <h1>ğŸ† Hall of Warriors ğŸ†</h1>
        <p>The greatest warriors who have conquered the most levels</p>

        <div id="leaderboard-content"></div>

        <div style="margin-top: 20px;">
            <a href="index.html" class="btn">âš”ï¸ Return to Battle</a>
            <button class="btn btn-secondary" onclick="logout()">ğŸšª Leave Arena</button>
        </div>
    </div>

    <script>
        function loadLeaderboard() {
            const users = JSON.parse(localStorage.getItem('typingBattleUsers') || '{}');
            const currentUser = localStorage.getItem('currentUser');
            const content = document.getElementById('leaderboard-content');

            if (Object.keys(users).length === 0) {
                content.innerHTML = '<div class="no-data">ğŸŸï¸ The arena awaits its first warriors! Be the first to enter battle!</div>';
                return;
            }

            // Convert users object to array and sort by maxLevel
            const sortedUsers = Object.entries(users)
                .map(([username, data]) => ({ username, ...data }))
                .sort((a, b) => b.maxLevel - a.maxLevel);

            let tableHTML = `
                <table class="leaderboard-table">
                    <thead>
                        <tr>
                            <th class="rank">ğŸ… Rank</th>
                            <th>âš”ï¸ Warrior</th>
                            <th>ğŸ—² Max Level</th>
                            <th>ğŸ¯ Battles Fought</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            sortedUsers.forEach((user, index) => {
                const rank = index + 1;
                const isCurrentUser = user.username === currentUser;
                const rankClass = rank <= 3 ? `rank-${rank}` : '';
                const rowClass = isCurrentUser ? 'current-user' : '';

                let rankDisplay = rank;
                if (rank === 1) rankDisplay = 'ğŸ¥‡';
                else if (rank === 2) rankDisplay = 'ğŸ¥ˆ';
                else if (rank === 3) rankDisplay = 'ğŸ¥‰';

                tableHTML += `
                    <tr class="${rowClass}">
                        <td class="rank ${rankClass}">${rankDisplay}</td>
                        <td>${user.username}${isCurrentUser ? ' (You)' : ''}</td>
                        <td>${user.maxLevel}</td>
                        <td>${user.gamesPlayed}</td>
                    </tr>
                `;
            });

            tableHTML += '</tbody></table>';
            content.innerHTML = tableHTML;
        }

        function logout() {
            localStorage.removeItem('currentUser');
            window.location.href = 'signup.html';
        }

        // Check if user is logged in
        if (!localStorage.getItem('currentUser')) {
            window.location.href = 'signup.html';
        }

        loadLeaderboard();
    </script>
</body>
</html>
